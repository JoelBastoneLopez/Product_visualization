<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurador Go!</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body { margin: 0; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; }
        .wrapper { display: flex; flex: 1; flex-direction: column; }
        model-viewer { width: 100%; flex: 1; background: #f4f4f4; }
        .controls { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
            padding: 15px; 
            background: #fff; 
            border-top: 1px solid #ddd; 
        }
        button { 
            padding: 12px; 
            font-size: 11px; 
            font-weight: bold; 
            text-transform: uppercase; 
            cursor: pointer; 
            border: none; 
            background: #333; 
            color: white; 
            border-radius: 4px;
        }
        button:active { background: #000; }
    </style>
</head>
<body>

<div class="configurador-wrapper">
    <div class="viewer-section">
        <model-viewer id="visor" 
            src="https://raw.githack.com/JoelBastoneLopez/Product_visualization/main/retopo_go.glb" 
            ar ar-modes="webxr scene-viewer quick-look" 
            camera-controls shadow-intensity="1">
            <button slot="ar-button" style="background: white; border-radius: 4px; border: none; position: absolute; top: 16px; right: 16px; padding: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                ðŸ‘‹ VER EN AR
            </button>
        </model-viewer>
    </div>

    <div class="controls-section">
        <h2>PersonalizaciÃ³n</h2>

        <div class="categoria">
            <label>Contratapa</label>
            <div class="opciones">
                <button onclick="location.reload()">Original</button>
                <button class="cemento" onclick="cambiar(1, 'tapa_baseColor.png')">Cemento</button>
            </div>
        </div>

        <div class="categoria">
            <label>Tapa Principal</label>
            <div class="opciones">
                <button onclick="location.reload()">Original</button>
                <button class="cemento" onclick="cambiar(4, 'contratapa_baseColor.png')">Cemento</button>
            </div>
        </div>

        <div class="categoria">
            <label>Logos</label>
            <div class="opciones">
                <button onclick="location.reload()">Original</button>
                <button class="cemento" onclick="cambiar(2, 'Logos_baseColor.png')">Cemento</button>
            </div>
        </div>

        <div class="categoria">
            <label>Calco Ruedas</label>
            <div class="opciones">
                <button onclick="location.reload()">Original</button>
                <button class="cemento" onclick="cambiar(0, 'calco_rueda__baseColor.png')">Cemento</button>
            </div>
        </div>

        <button class="btn-reset" onclick="location.reload()">RESETEAR TODO</button>
    </div>
</div>

<script>
    async function cambiar(indice, archivo) {
        const modelViewer = document.querySelector("#visor");
        const url = `https://raw.githack.com/JoelBastoneLopez/Product_visualization/main/op2/${archivo}`;
        
        if (!modelViewer.model) return;

        try {
            const texture = await modelViewer.createTexture(url);
            const material = modelViewer.model.materials[indice];
            
            if (material) {
                if (material.pbrMetallicRoughness.baseColorTexture) {
                    material.pbrMetallicRoughness.baseColorTexture.setTexture(texture);
                } else {
                    material.pbrMetallicRoughness.baseColorTexture = { texture: texture };
                }
                material.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 1]);
            }
        } catch (e) {
            console.error("Error cargando textura:", e);
        }
    }
</script>

</body>
</html>


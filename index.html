<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurador Go! V6</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; 
            font-family: 'Lato', sans-serif; 
            height: 100vh; 
            display: flex; 
            overflow: hidden; }
        
        .configurador-container { display: flex; 
            width: 100%; 
            height: 100%; }

        /* Visualizador a la izquierda */
        .viewer-section { flex: 1; background: #f4f4f4; position: relative; }
        model-viewer { width: 100%; height: 100%; }

        

        /* Panel de controles a la derecha */
        .controls-panel { 
            width: 320px; 
            background: #ffffff; 
            border-left: 1px solid #e0e0e0; 
            padding: 30px 20px; 
            overflow-y: auto;
            box-shadow: -2px 0 10px rgba(0,0,0,0.05);
        }

        h2 { 
            font-size: 18px; 
            font-weight: 100;
            letter-spacing: 1px; 
            margin-bottom: 30px; 
            border-bottom: 1px solid #000; 
            padding-bottom: 10px; 
        }

        .categoria { margin-bottom: 25px; }
        
        .categoria-titulo { 
            display: block; 
            font-size: 11px; 
            font-weight: 700; 
            text-transform: uppercase; 
            color: #555; 
            margin-bottom: 12px; 
            letter-spacing: 1px;
        }

        .opciones-botones { display: flex; gap: 12px; align-items: center; }

        /* Botones Circulares */
        .btn-circular {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #e0e0e0; /* Gris claro solicitado */
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s;
            padding: 0;
            outline: none;
        }

        .btn-circular:hover { transform: scale(1.1); border-color: #bbb; }
        .btn-circular:active { transform: scale(0.95); }

        /* Colores específicos */
        .color-cemento { background-color: #070C11; }
        .color-rojo { background-color: #3F0509; }
        .color-moca { background-color: #441F15; }
        .color-original { background-color: #B37D18; }

        

.watermark {
    position: absolute;
    bottom: 20px;   /* Distancia desde abajo */
    left: 20px;     /* Distancia desde la izquierda (o usa 'right' para la derecha) */
    width: 120px;   /* Tamaño del logo */
    opacity: 0.3;   /* Baja opacidad (0.3 = 30%) */
    pointer-events: none; /* Hace que el logo sea "invisible" a los clics para no trabar el 3D */
    z-index: 10;    /* Lo pone por encima del visor */
}

        .btn-reset-general { 
            display: block;        /* Necesario para que margin: auto funcione */
            margin: 20px auto 0;   /* Arriba 20px, lados Automático, abajo 0 */
            width: auto;           /* Se ajusta al contenido */
            padding: 14px; 
            background: #000; 
            color: #fff; 
            border: none; 
            font-size: 14px; 
            cursor: pointer;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            body { flex-direction: column; overflow: auto; }
            .configurador-container { flex-direction: column; }
            .controls-panel { width: 100%; border-left: none; border-top: 1px solid #e0e0e0; box-sizing: border-box; }
        }
    </style>
</head>
<body>

<div class="configurador-container">
    <div class="viewer-section">

            <img src="https://raw.githubusercontent.com/JoelBastoneLopez/Product_visualization/main/primicia-lab-logo.png" class="watermark">

        <model-viewer id="visor" 
            src="https://raw.githack.com/JoelBastoneLopez/Product_visualization/main/retopo_go.glb" 
            ar camera-controls shadow-intensity="1" exposure="1">
        </model-viewer>
    </div>

    <div class="controls-panel">
        <h2>Personalización</h2>

        <div class="categoria">
            <span class="categoria-titulo">Tapa Principal</span>
            <div class="opciones-botones">
                <button class="btn-circular color-original" title="Original" onclick="cambiar(4, 'Image_4.png')"></button>
                <button class="btn-circular color-cemento" title="Cemento" onclick="cambiar(4, 'tapa_baseColor.png')"></button>
                <button class="btn-circular color-rojo" title="Rojo" onclick="cambiar(4, 'tapa_baseColor-rojo.png')"></button>
                <button class="btn-circular color-moca" title="Moca" onclick="cambiar(4, 'tapa_baseColor-moca.png')"></button>
            </div>
        </div>

        <div class="categoria">
            <span class="categoria-titulo">Contratapa</span>
            <div class="opciones-botones">
                <button class="btn-circular color-original" title="Original" onclick="cambiar(1, 'Image_16.png')"></button>
                <button class="btn-circular color-cemento" title="Cemento" onclick="cambiar(1, 'contratapa_baseColor.png')"></button>
                <button class="btn-circular color-rojo" title="Rojo" onclick="cambiar(1, 'contratapa_baseColor-rojo.png')"></button>
                <button class="btn-circular color-moca" title="Moca" onclick="cambiar(1, 'contratapa_baseColor-moca.png')"></button>
            </div>
        </div>

        <div class="categoria">
            <span class="categoria-titulo">Calco Ruedas</span>
            <div class="opciones-botones">
                <button class="btn-circular color-original" title="Original" onclick="cambiar(0, 'Image_0.png')"></button>
                <button class="btn-circular color-cemento" title="Cemento" onclick="cambiar(0, 'calco_rueda__baseColor.png')"></button>
                <button class="btn-circular color-rojo" title="Rojo" onclick="cambiar(0, 'calco_rueda__baseColor-rojo.png')"></button>
                <button class="btn-circular color-moca" title="Moca" onclick="cambiar(0, 'calco_rueda__baseColor-moca.png')"></button>
            </div>
        </div>

        <div class="categoria">
            <span class="categoria-titulo">Logos</span>
            <div class="opciones-botones">
                <button class="btn-circular color-original" title="Original" onclick="cambiar(2, 'Image_8.png')"></button>
                <button class="btn-circular color-cemento" title="Cemento" onclick="cambiar(2, 'Logos_baseColor.png')"></button>
                <button class="btn-circular color-rojo" title="Rojo" onclick="cambiar(2, 'Logos_baseColor-rojo.png')"></button>
                <button class="btn-circular color-moca" title="Moca" onclick="cambiar(2, 'Logos_baseColor-moca.png')"></button>
            </div>
        </div>

        <button class="btn-reset-general" onclick="location.reload()">Volver a empezar</button>
    </div>
</div>

<script>
    async function cambiar(indice, archivo) {
        const visor = document.querySelector("#visor");
        const url = `https://raw.githack.com/JoelBastoneLopez/Product_visualization/main/${archivo}?v=${new Date().getTime()}`;
        
        if (!visor.model) return;

        try {
            const texture = await visor.createTexture(url);
            const material = visor.model.materials[indice];
            
            if (material) {
                if (material.pbrMetallicRoughness.baseColorTexture) {
                    material.pbrMetallicRoughness.baseColorTexture.setTexture(texture);
                } else {
                    material.pbrMetallicRoughness.setBaseColorTexture(texture);
                }
                material.pbrMetallicRoughness.setBaseColorFactor([1, 1, 1, 1]);
            }
        } catch (e) {
            console.error("Error al cargar la textura:", e);
        }
    }
</script>

</body>
</html>